(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{282:function(e,t,n){e.exports=n(665)},665:function(e,t,n){"use strict";n.r(t);var o=n(5),a=n(0),r=n.n(a),i=n(91),c=n.n(i),s=n(273),l=n(44);var u=function(e){var t=e.todos;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("br",null),0===t.length?r.a.createElement("h1",null,"All done"):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8"},r.a.createElement("h5",null,"Todo List")),r.a.createElement("div",{className:"col-md-4 text-right"},r.a.createElement("h5",null,t.length," todos left"))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("ul",{className:"list-group"},t.map(function(e,t){return r.a.createElement("li",{key:t.toString(),className:"list-group-item"},e)}))))))};var d=function(e){var t=e.badges,n=e.text,o=e.isSpeaking,a=e.onCompleteTodo;return r.a.createElement("div",{className:"Todo ".concat(o?"speaking":"")},r.a.createElement("h4",null,r.a.createElement("i",{className:"material-icons",style:{position:"absolute",bottom:10,right:20,color:"#99979c"}},"event"),n,r.a.createElement("button",{className:"float-right btn btn-success btn-sm",style:{marginLeft:10},onClick:a},"Complete")),r.a.createElement("p",null,t.map(function(e,t){var n=e.color,o=e.children;return r.a.createElement("span",{key:t.toString(),className:"badge badge-".concat(n),style:{marginRight:6}},o)})))};var m=Object(a.memo)(function(e){var t=e.notify,n=e.onCompleteTodo,o=e.id;Object(a.useEffect)(function(){"warning"===e.datetimecolor&&t()},[e.datetimetext]);var i=[{children:e.datetimetext,color:e.datetimecolor},{children:e.prioritytext,color:e.prioritycolor}];return r.a.createElement(d,{badges:i,onCompleteTodo:function(){return n(o)},text:e.text})}),f=function(e){var t=e.toggleTodo,n=e.todos,a=e.uid,i=e.userFieldId,c=e.notify,s=n.map(function(e){return r.a.createElement(m,Object.assign({},e,{notify:function(){return c(Object(o.a)({},e,{userFieldId:i,text:e.text+" "+e.datetimetext}))},onCompleteTodo:function(){return t(e,a)}}))});return r.a.createElement(u,{todos:s})},p=n(11),g=n(12),b=Object(g.d)(Object(p.firebaseConnect)(["todos"]),Object(l.b)(function(e){return{firebaseTodos:e.firebase.data.todos}}))(f),v=b,E=n(281),h=n(276),O=n.n(h),y=["Noteworthy","Significant","Important"],j=["info","secondary","primary"];function T(e){var t=e.todo,n=e.onSubmit,o=e.onDatetimeChange,a=e.onPriorityChange,i=e.onTextChange,c=e.onAdd;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("br",null),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{className:"form-control text",type:"text",required:!0,value:t.text,autoFocus:!0,placeholder:"Write a todo",onKeyUp:n,onChange:i}),r.a.createElement(O.a,{locale:"nl-NL",minDate:new Date,onChange:o,value:t.datetime}),r.a.createElement("select",{className:"form-control priority",value:t.priority||0,onChange:a},r.a.createElement("option",{value:0},y[0]),r.a.createElement("option",{value:1},y[1]),r.a.createElement("option",{value:2},y[2])),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-primary",onClick:c},"Add")))))}var N=n(280),w=n(92),k=n(277),S=n.n(k),C=n(20),I=n(60),x=n.n(I),F="UPDATE_TIME_FIELDS",R="NOTIFICATION",D="REMOVE_NOTIFICATION",_=function(e,t){return t.priority-e.priority},P=function(e){return!e.completed},M=function(e,t){return e.providerData[0].uid===t},A=function(e){return null!==e&&e.hasOwnProperty("id")&&e.hasOwnProperty("text")&&e.hasOwnProperty("datetime")},L=function(e){return null!==e&&e.hasOwnProperty("email")},U=function(e){return e.providerData[0].uid},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(C.parse)(e.datetime);return Object(C.isAfter)(Date.now(),t)?"danger":Object(C.differenceInMinutes)(t,Date.now())<5?"warning":"success"},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(C.parse)(e.datetime);return Object(C.distanceInWordsToNow)(t,{includeSeconds:!0,addSuffix:!0})};var q=function(){return{text:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",priority:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,datetime:arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date}};function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case F:case p.actionTypes.SET:return Object.keys(t.todos).reduce(function(n,a){return Object(o.a)({},n,Object(w.a)({},a,function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n.type){case p.actionTypes.SET:return A(n.todo)?e(Object(o.a)({},n.todo,{prioritycolor:j[n.todo.priority],prioritytext:y[n.todo.priority]}),{type:F}):t;case F:return Object(o.a)({},t,{datetimecolor:X(t),datetimetext:W(t)});default:return t}}(e[a],Object(o.a)({},t,{todo:t.todos[a]}))))},e);default:return e}}var Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{uid:void 0,userFieldId:void 0,todos:{},currentTime:Date.now(),notifications:[]},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case F:return Object(o.a)({},e,{currentTime:Date.now(),todos:J(e.todos,Object(o.a)({},t,{todos:e.todos}))});case R:return Object(o.a)({},e,{notifications:Object(N.a)(e.notifications).concat([t.payload])});case D:return Object(o.a)({},e,{notifications:e.notifications.filter(function(e){return e.id!==t.payload})});case p.actionTypes.LOGOUT:return Object(o.a)({},e,{uid:void 0,userFieldId:void 0,todos:{}});case p.actionTypes.SET_PROFILE:return L(t.profile)?Object(o.a)({},e,{uid:U(t.profile),user:t.profile}):e;case p.actionTypes.SET:return t&&t.path?function(e,t){if(!t.hasOwnProperty("data")||null===t.data)return console.warn("ignored action",t),e;switch(t.path){case"todos":return t.data.hasOwnProperty(e.uid)?Object(o.a)({},e,{todos:J(e.todos,Object(o.a)({},t,{todos:t.data[e.uid]}))}):e;case"users":return Object(o.a)({},e,{userFieldId:Object.keys(t.data).reduce(function(n,o){return M(t.data[o],e.uid)?o:n},e.userFieldId)});default:return e}}(e,t):e;default:return e}},V=function(e){var t=e.addTodo,n=e.uid,i=e.firebase,c=Object(a.useState)(q),s=Object(E.a)(c,2),l=s[0],u=s[1];function d(){""!==l.text&&(t(l,n,i)&&u(Object(o.a)({},l,{text:""})))}return r.a.createElement("div",null,r.a.createElement(T,{todo:l,onSubmit:function(e){13===e.keyCode&&d()},onAdd:d,onPriorityChange:function(e){u(Object(o.a)({},l,{priority:e.target.value}))},onDatetimeChange:function(e){u(Object(o.a)({},l,{datetime:e}))},onTextChange:function(e){u(Object(o.a)({},l,{text:e.target.value}))}}))},z=V,B=n(21),G=n.n(B);n(604),n(606),n(666),n(610);n(613)({origin:!0});G.a.initializeApp({apiKey:"AIzaSyCcSDFLCkpRMSeujLrSdQqYb3iwQk7fS-M",authDomain:"chama-hooks.firebaseapp.com",databaseURL:"https://chama-hooks.firebaseio.com",projectId:"chama-hooks",storageBucket:"chama-hooks.appspot.com",messagingSenderId:"518384846061"});G.a.database(),new G.a.auth.GoogleAuthProvider,G.a.auth();var K=G.a.messaging();K.usePublicVapidKey("BN8krSM0CRd6YdRwSXa1xosJyF0236U39Ftk27Rr7lnkrLtsAba9XQ4cUSGyQMkzRkhEJ7iaR1p6WOjHFNRRdu0");var Y=G.a.functions().httpsCallable("sendNotifications"),H=G.a,Z=(G.a,Object(g.c)({firebase:p.firebaseStateReducer,app:Q})),$={userProfile:"users",todos:"todos"},ee=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):g.d)(Object(g.a)(x.a))(g.e),te=function(e){return Object(g.d)(Object(p.reactReduxFirebase)(H,$))(ee)(Z,{})},ne=n(279),oe=function(e){var t=e.logout,n=e.login,o=e.uid,a=e.app,i=e.removeNotification;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null)),r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},o?r.a.createElement("button",{className:"btn btn-danger",onClick:function(){return t()}},"Logout ",a.user.displayName):r.a.createElement("button",{className:"btn btn-success",onClick:function(){return n()}},"Login")))),r.a.createElement(ne.a,{position:"bottom-right",timeout:3e3,alerts:a.notifications,onDismiss:function(e){return i(e.id)}}))};n.d(t,"App",function(){return ae});var ae=Object(g.d)(Object(p.firebaseConnect)(["users"]),Object(l.b)(function(e){return Object(o.a)({},e,{uid:e.app.uid,userFieldId:e.app.userFieldId,todos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.values(e.todos).filter(P).sort(_)}(e.app)})},function(e,t){var n=t.firebase;return{login:function(){n.login({provider:"google",type:"popup"})},logout:function(){n.logout()},removeNotification:function(t){e(function(e){return{type:D,payload:e}}(t))},notify:Y,setFCM:function(e,t){console.log("set token"),n.set("users/".concat(t,"/notificationTokens/").concat(e),!0)},toggleTodo:function(e,t){n.set("todos/".concat(t,"/").concat(e.id,"/completed"),!e.completed)},addTodo:function(e,t){if(!t)return n.login({provider:"google",type:"popup"}),!1;var a=function(e){var t=S()(e.text),n=Object(C.format)(e.datetime);return Object(o.a)({},e,{id:t,datetime:n})}(e);return n.set("todos/".concat(t,"/").concat(a.id),a)},startTimer:function(){e({type:I.START_TIMER,payload:{actionName:F,timerName:"updateTimeFields",timerPeriod:2e4}})},stopTimer:function(){e({type:I.STOP_TIMER,payload:{timerName:"updateTimeFields"}})},setUpMessaging:function(t,n){return K.onTokenRefresh(function(){K.getToken().then(function(e){n(e,t)}).catch(function(e){console.log("Unable to retrieve refreshed token ",e)})}),K.onMessage(function(t){var n;e({type:R,payload:{id:(n=t).from,type:"warning",message:n.data.title}})}),K.requestPermission().then(function(){return K.getToken()}).then(function(e){return n(e,t)}).catch(function(e){"messaging/permission-blocked"===e.code?console.log("Please Unblock Notification Request Manually"):console.log("Error Occurred",e)}),function(){K.onMessage(function(){}),K.onTokenRefresh(function(){})}}}}))(function(e){var t=e.startTimer,n=e.stopTimer,o=e.setUpMessaging,i=e.setFCM,c=e.userFieldId;return Object(a.useEffect)(function(){if(c)return o(c,i),t(),function(){return n()}},[c]),r.a.createElement("div",null,r.a.createElement(z,e),e.uid?r.a.createElement(v,e):null,r.a.createElement(oe,e))}),re=te({todos:[]}),ie=document.getElementById("root");c.a.render(r.a.createElement(s.a,{value:re},r.a.createElement(l.a,{store:re},r.a.createElement(ae,null))),ie),"serviceWorker"in navigator&&navigator.serviceWorker.register("./firebase-messaging-sw.js").then(function(e){console.log("Registration successful, scope is:",e.scope)}).catch(function(e){console.log("Service worker registration failed, error:",e)})}},[[282,2,1]]]);
//# sourceMappingURL=main.3e4f3319.chunk.js.map